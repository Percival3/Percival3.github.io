---
// src/components/Navigation.astro
import ThemeToggle from './ThemeToggle';
// 引入新的语言选择器组件
import LanguageSelector from './LanguageSelector';
import { getRelativeLocaleUrl } from 'astro:i18n';

interface Props {
  lang: string;
}

const { lang } = Astro.props;

// 1. 定义导航菜单 (加入了 Papers 和 Archive)
const navItems = {
  zh: [
    { name: '首页', href: '' },
    { name: '博客', href: 'posts/demo' },
    { name: '论文', href: '#' },   // 新增
    { name: '归档', href: '#' },   // 新增
    { name: '关于', href: '#' },
  ],
  en: [
    { name: 'Home', href: '' },
    { name: 'Blog', href: 'posts/demo' },
    { name: 'Papers', href: '#' }, // New
    { name: 'Archive', href: '#' },// New
    { name: 'About', href: '#' },
  ],
  ja: [
    { name: 'ホーム', href: '' },
    { name: 'ブログ', href: 'posts/demo' },
    { name: '論文', href: '#' },   // 新規
    { name: 'アーカイブ', href: '#' }, // 新規
    { name: '私について', href: '#' },
  ]
};

const items = navItems[lang as keyof typeof navItems];

// 2. 准备语言选择器所需的数据
const languages = [
  { code: 'zh', label: '中文', url: getRelativeLocaleUrl('zh', '') },
  { code: 'en', label: 'English', url: getRelativeLocaleUrl('en', '') },
  { code: 'ja', label: '日本語', url: getRelativeLocaleUrl('ja', '') },
];
---

<header class="sticky top-0 z-50 w-full bg-white/30 dark:bg-gray-950/70 backdrop-blur-md transition-all duration-300">
  <div class="container mx-auto px-4 h-16 flex items-center justify-between">
    <!-- Logo -->
    <a href={getRelativeLocaleUrl(lang, '')} class="font-bold text-xl tracking-tight flex items-center gap-2 hover:opacity-80 transition-opacity">
      <div class="w-8 h-8 rounded-lg bg-gradient-to-br from-blue-600 to-purple-600 flex items-center justify-center text-white text-sm shadow-sm">
        A
      </div>
      <span class="hidden sm:inline">Astro<span class="text-blue-600 dark:text-blue-400">V5</span></span>
    </a>

    <!-- 中间导航链接 (桌面端显示，移动端隐藏) -->
    <!-- 增加 md:flex 让它在平板及以上显示，gap-6 保持间距 -->
    <nav class="hidden md:flex items-center gap-6 text-sm font-medium text-gray-600 dark:text-gray-300 absolute left-1/2 transform -translate-x-1/2">
      {items.map(item => (
        <a 
          href={item.href === '' ? getRelativeLocaleUrl(lang, '') : getRelativeLocaleUrl(lang, item.href)} 
          class="hover:text-blue-600 dark:hover:text-blue-400 transition-colors relative group"
        >
          {item.name}
          <!-- 简单的下划线动画效果 -->
          <span class="absolute -bottom-1 left-0 w-0 h-0.5 bg-blue-600 transition-all group-hover:w-full"></span>
        </a>
      ))}
    </nav>
    
    <!-- 右侧功能区 -->
    <div class="flex items-center gap-2 sm:gap-4">
      <!-- 语言切换器：必须加 client:load 因为它是 React 组件且包含交互 -->
      <LanguageSelector client:load currentLang={lang} languages={languages} />
      
      <!-- 分隔线 -->
      <div class="w-px h-4 bg-gray-200 dark:bg-gray-700 hidden sm:block"></div>
      
      <!-- 主题切换 -->
      <ThemeToggle client:load />
    </div>
  </div>
</header>